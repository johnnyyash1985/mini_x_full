{% extends 'base.html' %}
{% block content %}
<div class="bg-white rounded-2xl shadow p-4 mb-4">
  <form method="post" class="space-y-2">
    {% csrf_token %}
    <textarea name="content" rows="3" maxlength="280" placeholder="What’s happening?"
      class="w-full border rounded-xl p-3"></textarea>
    <div class="text-right">
      <button type="submit" class="px-4 py-2 rounded-xl bg-black text-white hover:opacity-90">Post</button>
    </div>
  </form>
</div>

<div class="space-y-3">
  {% for post in posts %}
    <div class="bg-white rounded-2xl shadow p-4">
      <div class="flex items-center gap-2 text-sm text-gray-500">
        <a class="font-semibold text-gray-800 hover:underline" href="/profiles/{{ post.user.username }}/">@{{ post.user.username }}</a>
        <span>•</span>
        <a class="hover:underline" href="{% url 'post_detail' post.id %}" title="{{ post.created }}">
          {{ post.created|timesince }} ago
        </a>
        {% if post.reposted_from %}
          <span class="ml-auto text-xs px-2 py-1 rounded-full bg-gray-100">Repost</span>
        {% endif %}
      </div>

      <a class="block mt-2 hover:underline" href="{% url 'post_detail' post.id %}">
        <p class="whitespace-pre-wrap">{{ post.content }}</p>
      </a>

      <!-- Icon-only actions (comment icon links to detail) -->
      <div class="mt-3 flex items-center gap-6 text-xl">
        <a class="hover:opacity-70" href="{% url 'like_post' post.id %}" title="Like">
          {% if request.user in post.likes.all %}
            <i class="fa-solid fa-heart"></i>
          {% else %}
            <i class="fa-regular fa-heart"></i>
          {% endif %}
          <span class="text-sm align-middle ml-1">{{ post.likes.count }}</span>
        </a>
        <a class="hover:opacity-70" href="{% url 'repost' post.id %}" title="Repost">
          <i class="fa-solid fa-retweet"></i>
        </a>
        <a class="hover:opacity-70" href="{% url 'post_detail' post.id %}" title="Comments">
          <i class="fa-regular fa-comment"></i>
          <span class="text-sm align-middle ml-1">{{ post.comments.count }}</span>
        </a>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}
